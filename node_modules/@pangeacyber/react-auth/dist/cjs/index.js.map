{"version":3,"file":"index.js","sources":["../../src/AuthNClient/index.ts","../../node_modules/lodash/_arrayReduce.js","../../node_modules/lodash/_basePropertyOf.js","../../node_modules/lodash/_deburrLetter.js","../../node_modules/lodash/_root.js","../../node_modules/lodash/_freeGlobal.js","../../node_modules/lodash/_Symbol.js","../../node_modules/lodash/_arrayMap.js","../../node_modules/lodash/isArray.js","../../node_modules/lodash/_getRawTag.js","../../node_modules/lodash/_objectToString.js","../../node_modules/lodash/_baseGetTag.js","../../node_modules/lodash/isObjectLike.js","../../node_modules/lodash/isSymbol.js","../../node_modules/lodash/_baseToString.js","../../node_modules/lodash/toString.js","../../node_modules/lodash/deburr.js","../../node_modules/lodash/_asciiWords.js","../../node_modules/lodash/_hasUnicodeWord.js","../../node_modules/lodash/_unicodeWords.js","../../node_modules/lodash/words.js","../../node_modules/lodash/_createCompounder.js","../../node_modules/lodash/snakeCase.js","../../src/shared/utils.ts","../../src/shared/session.ts","../../src/shared/hooks.ts","../../src/AuthProvider/index.tsx","../../src/ComponentAuthProvider/index.tsx","../../src/AuthNFlow/types.ts","../../src/AuthNFlow/client.ts","../../src/AuthNFlow/provider.tsx"],"sourcesContent":["import axios from \"axios\";\nconst API_VERSION = \"v1\";\nexport class AuthNClient {\n    constructor(config, useJwt = false) {\n        if (!config.clientToken)\n            throw new Error(\"A token is required\");\n        if (!config.domain)\n            throw new Error(\"A domain is required\");\n        if (!config.callbackUri && typeof window !== \"undefined\") {\n            config.callbackUri = window.location.origin;\n        }\n        this.config = {\n            ...config,\n        };\n    }\n    /*\n      General AuthN functions\n    */\n    async logout(userToken) {\n        const path = \"client/session/logout\";\n        const data = { token: userToken };\n        return await this.post(path, data);\n    }\n    async validate(userToken) {\n        const path = \"client/token/check\";\n        const payload = { token: userToken };\n        return await this.post(path, payload);\n    }\n    async userinfo(code) {\n        const path = \"client/userinfo\";\n        const payload = { code: code };\n        return await this.post(path, payload);\n    }\n    async refresh(userToken, refreshToken) {\n        const path = \"client/session/refresh\";\n        const payload = { user_token: userToken, refresh_token: refreshToken };\n        return await this.post(path, payload);\n    }\n    async jwks() {\n        const path = \"client/jwks\";\n        return await this.post(path, {});\n    }\n    /*\n      API Request functions\n    */\n    async post(endpoint, payload) {\n        try {\n            const response = await axios.post(this.getUrl(endpoint), payload, this.getOptions());\n            const success = response.data?.status === \"Success\";\n            return { success, response: response.data };\n        }\n        catch (err) {\n            return { success: false, response: this.getError(err) };\n        }\n    }\n    getUrl(endpoint) {\n        const protocol = this.config.domain.match(/^local\\.?host(:\\d{2,5})?$/)\n            ? \"http\"\n            : \"https\";\n        return `${protocol}://authn.${this.config.domain}/${API_VERSION}/${endpoint}`;\n    }\n    getOptions() {\n        const options = {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: `Bearer ${this.config.clientToken}`,\n            },\n        };\n        return options;\n    }\n    getError(error) {\n        const message = {\n            status: \"Error\",\n            summary: \"\",\n            result: {},\n        };\n        if (axios.isAxiosError(error) && error.response) {\n            message.status = error.response.data.status;\n            message.summary = error.response.data.summary;\n            message.result = error.response.data.result;\n        }\n        else if (error.request) {\n            message.summary = `${error.request.status} ${error.request.statusText}`;\n            message.result = error.reqest;\n        }\n        else {\n            message.summary = \"Unhandled error\";\n            message.result = error;\n            console.log(\"Unhandled error\", error);\n        }\n        return message;\n    }\n}\nexport default AuthNClient;\n","/**\n * A specialized version of `_.reduce` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {*} [accumulator] The initial value.\n * @param {boolean} [initAccum] Specify using the first element of `array` as\n *  the initial value.\n * @returns {*} Returns the accumulated value.\n */\nfunction arrayReduce(array, iteratee, accumulator, initAccum) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  if (initAccum && length) {\n    accumulator = array[++index];\n  }\n  while (++index < length) {\n    accumulator = iteratee(accumulator, array[index], index, array);\n  }\n  return accumulator;\n}\n\nmodule.exports = arrayReduce;\n","/**\n * The base implementation of `_.propertyOf` without support for deep paths.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyOf(object) {\n  return function(key) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = basePropertyOf;\n","var basePropertyOf = require('./_basePropertyOf');\n\n/** Used to map Latin Unicode letters to basic Latin letters. */\nvar deburredLetters = {\n  // Latin-1 Supplement block.\n  '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n  '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n  '\\xc7': 'C',  '\\xe7': 'c',\n  '\\xd0': 'D',  '\\xf0': 'd',\n  '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n  '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n  '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n  '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n  '\\xd1': 'N',  '\\xf1': 'n',\n  '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n  '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n  '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n  '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n  '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n  '\\xc6': 'Ae', '\\xe6': 'ae',\n  '\\xde': 'Th', '\\xfe': 'th',\n  '\\xdf': 'ss',\n  // Latin Extended-A block.\n  '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n  '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n  '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n  '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n  '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n  '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n  '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n  '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n  '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n  '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n  '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n  '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n  '\\u0134': 'J',  '\\u0135': 'j',\n  '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n  '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n  '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n  '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n  '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n  '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n  '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n  '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n  '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n  '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n  '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n  '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n  '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n  '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n  '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n  '\\u0174': 'W',  '\\u0175': 'w',\n  '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n  '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n  '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n  '\\u0132': 'IJ', '\\u0133': 'ij',\n  '\\u0152': 'Oe', '\\u0153': 'oe',\n  '\\u0149': \"'n\", '\\u017f': 's'\n};\n\n/**\n * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n * letters to basic Latin letters.\n *\n * @private\n * @param {string} letter The matched letter to deburr.\n * @returns {string} Returns the deburred letter.\n */\nvar deburrLetter = basePropertyOf(deburredLetters);\n\nmodule.exports = deburrLetter;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var deburrLetter = require('./_deburrLetter'),\n    toString = require('./toString');\n\n/** Used to match Latin Unicode letters (excluding mathematical operators). */\nvar reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n/** Used to compose unicode character classes. */\nvar rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange;\n\n/** Used to compose unicode capture groups. */\nvar rsCombo = '[' + rsComboRange + ']';\n\n/**\n * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n */\nvar reComboMark = RegExp(rsCombo, 'g');\n\n/**\n * Deburrs `string` by converting\n * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n * letters to basic Latin letters and removing\n * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to deburr.\n * @returns {string} Returns the deburred string.\n * @example\n *\n * _.deburr('déjà vu');\n * // => 'deja vu'\n */\nfunction deburr(string) {\n  string = toString(string);\n  return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n}\n\nmodule.exports = deburr;\n","/** Used to match words composed of alphanumeric characters. */\nvar reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n/**\n * Splits an ASCII `string` into an array of its words.\n *\n * @private\n * @param {string} The string to inspect.\n * @returns {Array} Returns the words of `string`.\n */\nfunction asciiWords(string) {\n  return string.match(reAsciiWord) || [];\n}\n\nmodule.exports = asciiWords;\n","/** Used to detect strings that need a more robust regexp to match words. */\nvar reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n/**\n * Checks if `string` contains a word composed of Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a word is found, else `false`.\n */\nfunction hasUnicodeWord(string) {\n  return reHasUnicodeWord.test(string);\n}\n\nmodule.exports = hasUnicodeWord;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsDingbatRange = '\\\\u2700-\\\\u27bf',\n    rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n    rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n    rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n    rsPunctuationRange = '\\\\u2000-\\\\u206f',\n    rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n    rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n    rsVarRange = '\\\\ufe0e\\\\ufe0f',\n    rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n/** Used to compose unicode capture groups. */\nvar rsApos = \"['\\u2019]\",\n    rsBreak = '[' + rsBreakRange + ']',\n    rsCombo = '[' + rsComboRange + ']',\n    rsDigits = '\\\\d+',\n    rsDingbat = '[' + rsDingbatRange + ']',\n    rsLower = '[' + rsLowerRange + ']',\n    rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n    rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n    rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n    rsNonAstral = '[^' + rsAstralRange + ']',\n    rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n    rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n    rsUpper = '[' + rsUpperRange + ']',\n    rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nvar rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n    rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n    rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n    rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n    reOptMod = rsModifier + '?',\n    rsOptVar = '[' + rsVarRange + ']?',\n    rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n    rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n    rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq;\n\n/** Used to match complex or compound words. */\nvar reUnicodeWord = RegExp([\n  rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n  rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n  rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n  rsUpper + '+' + rsOptContrUpper,\n  rsOrdUpper,\n  rsOrdLower,\n  rsDigits,\n  rsEmoji\n].join('|'), 'g');\n\n/**\n * Splits a Unicode `string` into an array of its words.\n *\n * @private\n * @param {string} The string to inspect.\n * @returns {Array} Returns the words of `string`.\n */\nfunction unicodeWords(string) {\n  return string.match(reUnicodeWord) || [];\n}\n\nmodule.exports = unicodeWords;\n","var asciiWords = require('./_asciiWords'),\n    hasUnicodeWord = require('./_hasUnicodeWord'),\n    toString = require('./toString'),\n    unicodeWords = require('./_unicodeWords');\n\n/**\n * Splits `string` into an array of its words.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to inspect.\n * @param {RegExp|string} [pattern] The pattern to match words.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Array} Returns the words of `string`.\n * @example\n *\n * _.words('fred, barney, & pebbles');\n * // => ['fred', 'barney', 'pebbles']\n *\n * _.words('fred, barney, & pebbles', /[^, ]+/g);\n * // => ['fred', 'barney', '&', 'pebbles']\n */\nfunction words(string, pattern, guard) {\n  string = toString(string);\n  pattern = guard ? undefined : pattern;\n\n  if (pattern === undefined) {\n    return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n  }\n  return string.match(pattern) || [];\n}\n\nmodule.exports = words;\n","var arrayReduce = require('./_arrayReduce'),\n    deburr = require('./deburr'),\n    words = require('./words');\n\n/** Used to compose unicode capture groups. */\nvar rsApos = \"['\\u2019]\";\n\n/** Used to match apostrophes. */\nvar reApos = RegExp(rsApos, 'g');\n\n/**\n * Creates a function like `_.camelCase`.\n *\n * @private\n * @param {Function} callback The function to combine each word.\n * @returns {Function} Returns the new compounder function.\n */\nfunction createCompounder(callback) {\n  return function(string) {\n    return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n  };\n}\n\nmodule.exports = createCompounder;\n","var createCompounder = require('./_createCompounder');\n\n/**\n * Converts `string` to\n * [snake case](https://en.wikipedia.org/wiki/Snake_case).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to convert.\n * @returns {string} Returns the snake cased string.\n * @example\n *\n * _.snakeCase('Foo Bar');\n * // => 'foo_bar'\n *\n * _.snakeCase('fooBar');\n * // => 'foo_bar'\n *\n * _.snakeCase('--FOO-BAR--');\n * // => 'foo_bar'\n */\nvar snakeCase = createCompounder(function(result, word, index) {\n  return result + (index ? '_' : '') + word.toLowerCase();\n});\n\nmodule.exports = snakeCase;\n","// Copyright 2023 Pangea Cyber Corporation\n// Author: Pangea Cyber Corporation\nimport snakeCase from \"lodash/snakeCase\";\nconst BASE58_ALPHABET = \"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz\";\nexport const generateBase58 = (length) => {\n    let result = \"\";\n    const setLength = BASE58_ALPHABET.length;\n    for (let i = 0; i < length; i++) {\n        result += BASE58_ALPHABET.charAt(Math.floor(Math.random() * setLength));\n    }\n    return result;\n};\nconst bytesToHex = (uint8a) => {\n    let hex = \"\";\n    for (let i = 0; i < uint8a.length; i++) {\n        hex += uint8a[i].toString(16).padStart(2, \"0\");\n    }\n    return hex;\n};\nexport const encode58 = (source) => {\n    if (source.length === 0)\n        return \"\";\n    if (typeof source === \"string\") {\n        if (typeof TextEncoder !== \"undefined\") {\n            source = new TextEncoder().encode(source);\n        }\n        else {\n            source = new Uint8Array(source.split(\"\").map((c) => c.charCodeAt(0)));\n        }\n    }\n    let x = BigInt(\"0x\" + bytesToHex(source));\n    const output = [];\n    while (x > 0) {\n        const mod = Number(x % 58n);\n        x = x / 58n;\n        output.push(BASE58_ALPHABET[mod]);\n    }\n    for (let i = 0; source[i] === 0; i++) {\n        output.push(BASE58_ALPHABET[0]);\n    }\n    return output.reverse().join(\"\");\n};\nexport const toUrlEncoded = (obj) => {\n    return Object.keys(obj)\n        .map((k) => encodeURIComponent(snakeCase(k)) + \"=\" + encodeURIComponent(obj[k]))\n        .join(\"&\");\n};\n/**\n * isLocalhost - helper function to determine if a hostname is localhost\n * @param hostname {string}\n * @returns {boolean}\n * @example\n * isLocalhost(\"pangea.cloud\");\n * // false\n *\n * isLocalhost(\"127.0.0.1\");\n * // true\n */\nexport const isLocalhost = (hostname) => {\n    if (hostname === \"localhost\" || hostname === \"127.0.0.1\") {\n        return true;\n    }\n    return false;\n};\nexport const diffInSeconds = (dt1, dt2) => {\n    const diff = (dt1.getTime() - dt2.getTime()) / 1000;\n    return Math.round(diff);\n};\nexport const delay = (ms) => {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n};\n","import { isLocalhost, diffInSeconds } from \"./utils\";\nexport const REFRESH_CHECK_INTERVAL = 15; // Frequency of refresh check in seconds\nexport const REFRESH_CHECK_THRESHOLD = 10;\nexport const SESSION_DATA_KEY = \"pangea-session\";\nexport const TOKEN_COOKIE_NAME = \"pangea-token\";\nexport const REFRESH_COOKIE_NAME = \"pangea-refresh\";\nexport const DEFAULT_COOKIE_OPTIONS = {\n    useCookie: false,\n    cookieMaxAge: 60 * 60 * 24 * 2,\n    cookieName: TOKEN_COOKIE_NAME,\n    refreshCookieName: REFRESH_COOKIE_NAME,\n};\nconst BASE_COOKIE_FLAGS = \"; path=/\";\nconst CODE_RE = /[?&]code=[^&]+/;\nconst STATE_RE = /[?&]state=[^&]+/;\nexport const hasAuthParams = (searchParams = window.location.search) => CODE_RE.test(searchParams) && STATE_RE.test(searchParams);\n/*\n  Session storage functions\n*/\nexport function getStorageAPI(isUsingCookies) {\n    // Depending on if we're using cookies or not, we want to use a different storage Web API\n    // When we use a cookie, use session storage\n    // When we do not use a cookie, use local storage <--- default\n    return isUsingCookies ? window.sessionStorage : window.localStorage;\n}\nexport const saveSessionData = (data, options) => {\n    const storageAPI = getStorageAPI(options.useCookie);\n    const dataString = JSON.stringify(data);\n    storageAPI.setItem(options.sessionKey, dataString);\n};\nexport const getSessionData = (options) => {\n    const storageAPI = getStorageAPI(options.useCookie);\n    const data = storageAPI.getItem(options.sessionKey);\n    const sessionJSON = data ? JSON.parse(data) : {};\n    return sessionJSON;\n};\nexport const getSessionToken = (options) => {\n    if (options.useCookie) {\n        return getTokenFromCookie(options.cookieName);\n    }\n    const data = getSessionData(options);\n    return data?.user?.active_token?.token;\n};\nexport const getRefreshToken = (options) => {\n    if (options.useCookie) {\n        return getTokenFromCookie(options.refreshCookieName);\n    }\n    else {\n        const data = getSessionData(options);\n        return data?.user?.refresh_token?.token;\n    }\n};\nexport const getAllTokens = (options) => {\n    const sessionToken = getSessionToken(options) || \"\";\n    const refreshToken = getRefreshToken(options) || \"\";\n    return { sessionToken, refreshToken };\n};\nexport const getSessionTokenValues = (options) => {\n    if (options.useCookie) {\n        return getTokenCookieFields(options.cookieName);\n    }\n    const data = getSessionData(options);\n    return [\n        data?.user?.refresh_token?.token || \"\",\n        data?.user?.refresh_token?.expire || \"\",\n    ];\n};\nexport const getTokenCookieFields = (name) => {\n    const cookies = getCookies();\n    const cookie = cookies[name] || \"\";\n    const [token, expire] = cookie.split(\",\");\n    return [token || \"\", expire || \"\"];\n};\n/*\n  Support for fetching a token by name\n*/\nexport const getTokenFromCookie = (name) => {\n    const cookies = getCookies();\n    const cookie = cookies[name];\n    // token cookie should contain the value and expiration timestamp separated by a comma\n    if (cookie) {\n        const [token] = cookie.split(\",\");\n        return token || \"\";\n    }\n    else {\n        return \"\";\n    }\n};\n/*\n  Token refresh functions\n*/\n// Get the expire value of the session token, from cookie or storage\nexport const getTokenExpire = (options) => {\n    if (options.useCookie) {\n        const [_, expire] = getTokenCookieFields(options.cookieName);\n        return expire;\n    }\n    else {\n        const sessionData = getSessionData(options);\n        const user = sessionData.user;\n        return user?.refresh_token?.expire || \"\";\n    }\n};\nexport const isTokenExpiring = (expireTime) => {\n    const refreshExpires = new Date(expireTime);\n    const timeDiff = diffInSeconds(refreshExpires, new Date());\n    const threshold = REFRESH_CHECK_INTERVAL + REFRESH_CHECK_THRESHOLD;\n    return timeDiff < threshold;\n};\n/*\n  Cookie functions\n*/\nexport const maybeAddSecureFlag = (cookie, options) => {\n    const { cookieDomain } = options;\n    // Check the location.hostname\n    // if we're not at localhost, then add the Secure flag\n    // and also set the domain\n    if (!isLocalhost(window.location.hostname)) {\n        cookie += \"; Secure\";\n        // If we include a cookieDomain, then make sure to set it\n        // on the cookie\n        if (cookieDomain !== undefined) {\n            cookie += `; domain=${cookieDomain}`;\n        }\n    }\n    return cookie;\n};\nexport const getCookies = () => {\n    const cookies = document.cookie\n        .split(\";\")\n        .map((str) => str.trim())\n        .reduce((cookieObj, curr) => {\n        const [cookieName, cookieValue] = curr.split(\"=\");\n        if (cookieName !== \"\") {\n            cookieObj[cookieName] = cookieValue;\n        }\n        return cookieObj;\n    }, {});\n    return cookies;\n};\nexport const setCookie = (key, value = \"\", options) => {\n    const { cookieMaxAge } = options;\n    let cookie = `${key}=${value}${BASE_COOKIE_FLAGS}; max-age=${cookieMaxAge}`;\n    cookie = maybeAddSecureFlag(cookie, options);\n    document.cookie = cookie;\n};\nexport const removeCookie = (key, options) => {\n    const epoch = new Date(0);\n    let cookie = `${key}=${BASE_COOKIE_FLAGS}; expires=${epoch.toUTCString()}; max-age=0`;\n    cookie = maybeAddSecureFlag(cookie, options);\n    document.cookie = cookie;\n};\nexport const setTokenCookies = (userData, options) => {\n    const userToken = userData.active_token?.token || \"\";\n    const refreshToken = userData.refresh_token?.token || \"\";\n    const userExpire = userData.active_token?.expire || \"\";\n    const refreshExpire = userData.refresh_token?.expire || \"\";\n    const userCookieValue = `${userToken},${userExpire}`;\n    const refreshCookieValue = `${refreshToken},${refreshExpire}`;\n    setCookie(options.cookieName, userCookieValue, options);\n    setCookie(options.refreshCookieName, refreshCookieValue, options);\n};\nexport const removeTokenCookies = (options) => {\n    removeCookie(options.cookieName, options);\n    removeCookie(options.refreshCookieName, options);\n};\nexport const getUserFromResponse = (data) => {\n    // The token/check endpoint returns a different format thean userinfo and flow/complete\n    // Data only includes the active_token information in response.result\n    // TODO: need a fix for this for cookie sessions and refresh token support\n    const activeToken = data.result?.active_token?.token\n        ? { ...data.result.active_token }\n        : { ...data.result };\n    const refreshToken = data.result?.refresh_token?.token\n        ? { ...data.result.refresh_token }\n        : {};\n    const email = activeToken.email;\n    const profile = { ...activeToken.profile };\n    // remove deplicate user data from tokens\n    delete activeToken.email;\n    delete activeToken.profile;\n    delete refreshToken.email;\n    delete refreshToken.profile;\n    const user = {\n        email: email,\n        profile: profile,\n        active_token: activeToken,\n        refresh_token: refreshToken,\n    };\n    return user;\n};\n","import { useCallback, useEffect, useRef } from \"react\";\nimport * as jose from \"jose\";\nimport { getAllTokens, getSessionData, getTokenExpire, getUserFromResponse, isTokenExpiring, removeTokenCookies, saveSessionData, setTokenCookies, } from \"@src/shared/session\";\nimport { diffInSeconds } from \"@src/shared/utils\";\nexport const REFRESH_CHECK_INTERVAL = 15; // Frequency of refresh check in seconds\nexport const REFRESH_CHECK_THRESHOLD = 10;\nexport const JWKS_CACHE_KEY = \"jwks-cache\";\nexport const JWKS_EXPIRE = 60 * 60 * 24; // 24 hours in seconds\nexport const useValidateToken = (client, options, validateCallback) => {\n    const fetchJWKS = useCallback(async () => {\n        const { success, response } = await client.jwks();\n        if (success) {\n            if (response.result?.keys && response.result.keys.length > 0) {\n                return { keys: response.result.keys };\n            }\n            else {\n                console.warn(\"Error: empty JWKS response\");\n            }\n        }\n    }, []);\n    const checkKeys = useCallback((jwksJSON) => {\n        if (jwksJSON?.expire) {\n            const cacheExpires = new Date(jwksJSON?.expire);\n            const timeDiff = diffInSeconds(new Date(), cacheExpires);\n            return timeDiff < JWKS_EXPIRE;\n        }\n        return false;\n    }, []);\n    const getJWKS = useCallback(async () => {\n        const jwksData = localStorage.getItem(JWKS_CACHE_KEY);\n        const jwksJSON = JSON.parse(jwksData || \"{}\");\n        if (jwksData && checkKeys(jwksJSON)) {\n            return jwksJSON.keySet;\n        }\n        else {\n            const keySet = await fetchJWKS();\n            if (keySet) {\n                const cacheData = { expire: Date.now(), keySet: keySet };\n                localStorage.setItem(JWKS_CACHE_KEY, JSON.stringify(cacheData));\n                return keySet;\n            }\n            return { keys: [] };\n        }\n    }, []);\n    const verifyJwt = useCallback(async (token) => {\n        const result = {};\n        try {\n            const jwks = await getJWKS();\n            if (jwks?.keys?.length > 0) {\n                const keySet = jose.createLocalJWKSet(jwks);\n                const { payload, protectedHeader } = await jose.jwtVerify(token, keySet);\n                const profile = payload.profile;\n                const user = {\n                    email: payload.email,\n                    profile: {\n                        first_name: profile?.first_name,\n                        last_name: profile?.first_name,\n                        phone: profile?.phone,\n                    },\n                    header: protectedHeader,\n                    payload: payload,\n                };\n                result.user = user;\n            }\n            else {\n                result.error = \"Missing JSON Web Key Set\";\n            }\n        }\n        catch (error) {\n            console.warn(\"Error:\", error);\n            result.error = \"JWT validation failed\";\n        }\n        return result;\n    }, []);\n    const verifyToken = useCallback(async (token) => {\n        const { success, response } = await client.validate(token);\n        const result = {};\n        if (success) {\n            result.user = getUserFromResponse(response);\n        }\n        else {\n            removeTokenCookies(options);\n            result.error = response?.result?.summary || \"Token verification error\";\n        }\n        return result;\n    }, []);\n    const validate = useCallback(async (token) => {\n        const result = options?.useJwt\n            ? await verifyJwt(token)\n            : await verifyToken(token);\n        validateCallback(result);\n        if (result.user) {\n            const data = getSessionData(options);\n            // add tokens to user data\n            if (data) {\n                result.user.active_token = data.user?.active_token;\n                result.user.refresh_token = data.user?.refresh_token;\n            }\n        }\n        return result?.user;\n    }, []);\n    return validate;\n};\nexport const useRefresh = (client, options, refreshCallback, loadingCallback) => {\n    const intervalId = useRef(null);\n    useEffect(() => {\n        // event handlers to start/stop refresh checker\n        window.addEventListener(\"focus\", onFocus);\n        window.addEventListener(\"blur\", onBlur);\n        return () => {\n            window.removeEventListener(\"focus\", onFocus);\n            window.removeEventListener(\"blur\", onBlur);\n            if (intervalId.current) {\n                clearInterval(intervalId.current);\n                intervalId.current = null;\n            }\n        };\n    }, []);\n    const onBlur = useCallback(() => {\n        if (intervalId.current) {\n            clearInterval(intervalId.current);\n            intervalId.current = null;\n        }\n    }, []);\n    const onFocus = useCallback(() => {\n        loadingCallback(true);\n        checkTokenLife();\n        loadingCallback(false);\n        startTokenWatch();\n    }, []);\n    const checkTokenLife = useCallback(() => {\n        const tokenExpire = getTokenExpire(options);\n        if (tokenExpire && isTokenExpiring(tokenExpire)) {\n            refresh();\n        }\n    }, []);\n    const stopTokenWatch = useCallback(() => {\n        if (intervalId.current) {\n            clearInterval(intervalId.current);\n            intervalId.current = null;\n        }\n    }, []);\n    const startTokenWatch = useCallback(() => {\n        const intervalTime = REFRESH_CHECK_INTERVAL * 1000;\n        stopTokenWatch();\n        intervalId.current = window.setInterval(() => {\n            checkTokenLife();\n        }, intervalTime);\n    }, []);\n    const refresh = useCallback(async () => {\n        const { sessionToken, refreshToken } = getAllTokens(options);\n        const { success, response } = await client.refresh(sessionToken, refreshToken);\n        if (success) {\n            const data = getSessionData(options);\n            const user = getUserFromResponse(response);\n            data.user = user;\n            saveSessionData(data, options);\n            if (options.useCookie) {\n                setTokenCookies(user, options);\n            }\n            refreshCallback({ user });\n        }\n        else {\n            refreshCallback({ error: \"Refresh failed\" });\n        }\n    }, []);\n    return { refresh, startTokenWatch, stopTokenWatch };\n};\n","import { Fragment as _Fragment, jsx as _jsx } from \"react/jsx-runtime\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useState, } from \"react\";\nimport AuthNClient from \"@src/AuthNClient\";\nimport { toUrlEncoded, generateBase58 } from \"../shared/utils\";\nimport { getStorageAPI, getSessionData, getSessionToken, getSessionTokenValues, getUserFromResponse, hasAuthParams, saveSessionData, setTokenCookies, removeTokenCookies, isTokenExpiring, getTokenFromCookie, SESSION_DATA_KEY, DEFAULT_COOKIE_OPTIONS, } from \"@src/shared/session\";\nimport { useValidateToken, useRefresh } from \"../shared/hooks\";\n// const SESSION_DATA_KEY = \"pangea-authn\";\nconst STATE_DATA_KEY = \"state\";\nconst LAST_PATH_KEY = \"last-path\";\nconst AuthContext = createContext({});\nexport const AuthProvider = ({ loginUrl, config, onLogin, cookieOptions = { useCookie: false }, redirectPathname, redirectOnLogout = false, useStrictStateCheck = true, children, }) => {\n    const [authenticated, setAuthenticated] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(\"\");\n    const [user, setUser] = useState();\n    const client = useMemo(() => {\n        return new AuthNClient(config);\n    }, [config]);\n    // For local development, use port 4000 for API and 4001 for hosted UI\n    const slashRe = /\\/$/;\n    const loginURL = `${loginUrl.replace(slashRe, \"\")}/authorize`;\n    const signupURL = `${loginUrl.replace(slashRe, \"\")}/signup`;\n    const logoutURL = `${loginUrl.replace(slashRe, \"\")}/logout`;\n    const options = {\n        useJwt: config.useJwt,\n        sessionKey: config.sessionKey || SESSION_DATA_KEY,\n        ...DEFAULT_COOKIE_OPTIONS,\n        ...cookieOptions,\n    };\n    const validateCallback = useCallback((result) => {\n        if (result.user) {\n            const sessionData = getSessionData(options);\n            setAuthenticated(true);\n            setUser(result.user);\n            if (onLogin) {\n                const appState = {\n                    userData: sessionData.user,\n                    returnPath: window.location.pathname,\n                };\n                onLogin(appState);\n            }\n        }\n        else {\n            setError(result.error || \"Validation failed.\");\n        }\n        setLoading(false);\n    }, []);\n    const refreshCallback = useCallback((result) => {\n        if (result.user) {\n            setUser(result.user);\n            setAuthenticated(true);\n        }\n        else {\n            logout();\n        }\n        setLoading(false);\n    }, []);\n    const loadingCallback = useCallback((state) => {\n        setLoading(state);\n    }, []);\n    const validate = useValidateToken(client, options, validateCallback);\n    const { refresh, startTokenWatch, stopTokenWatch } = useRefresh(client, options, refreshCallback, loadingCallback);\n    useEffect(() => {\n        const [token, expire] = getSessionTokenValues(options);\n        if (hasAuthParams()) {\n            // if code and secret params are set, exchange code for a token\n            exchange();\n        }\n        else if (token) {\n            // if token is expiring or expired, try refreshing\n            if (expire && isTokenExpiring(expire)) {\n                refresh();\n            }\n            else {\n                // if token has not expired, validate that it's still good\n                validate(token);\n            }\n            startTokenWatch();\n        }\n        else {\n            // show unauthenticated state\n            setLoading(false);\n        }\n    }, []);\n    const exchange = async () => {\n        const queryString = window.location.search;\n        const urlParams = new URLSearchParams(queryString);\n        const storageAPI = getStorageAPI(options.useCookie);\n        const savedState = storageAPI.getItem(STATE_DATA_KEY);\n        const state = urlParams.get(\"state\");\n        const code = urlParams.get(\"code\");\n        // remove state and code params from the URL\n        urlParams.delete(\"state\");\n        urlParams.delete(\"code\");\n        const newSearch = urlParams.toString();\n        const newPath = newSearch\n            ? `${window.location.pathname}?${newSearch}`\n            : window.location.pathname;\n        history.pushState({}, document.title, newPath);\n        if (!state || !code) {\n            const msg = \"Missing required parameters\";\n            setError(msg);\n            setLoading(false);\n        }\n        else if (state !== savedState && useStrictStateCheck) {\n            const msg = \"Invalid session state\";\n            setError(msg);\n            setLoading(false);\n        }\n        else {\n            const { success, response } = await client.userinfo(code);\n            if (success) {\n                const token = response.result?.active_token?.token;\n                if (token) {\n                    // if using an opaque token or has a valid JWT\n                    if (!config?.useJwt || (config?.useJwt && (await validate(token)))) {\n                        processLogin(response);\n                    }\n                }\n                else {\n                    const msg = \"Missing Token\";\n                    setError(msg);\n                }\n            }\n            else {\n                setError(response.summary);\n            }\n            storageAPI.removeItem(STATE_DATA_KEY);\n            setLoading(false);\n        }\n    };\n    const login = () => {\n        const location = window.location;\n        const queryString = window.location.search;\n        const urlParams = new URLSearchParams(queryString);\n        const stateCode = generateBase58(32);\n        const storageAPI = getStorageAPI(options.useCookie);\n        storageAPI.setItem(STATE_DATA_KEY, stateCode);\n        storageAPI.setItem(LAST_PATH_KEY, `${location.pathname}${location.search}`);\n        let redirectUri = location.origin;\n        if (typeof redirectPathname === \"string\") {\n            redirectUri += redirectPathname;\n        }\n        const query = new URLSearchParams(\"\");\n        query.append(\"redirect_uri\", redirectUri);\n        query.append(\"state\", stateCode);\n        const queryParams = query.toString();\n        const redirectTo = urlParams.get(\"signup\") ? signupURL : loginURL;\n        const url = queryParams ? `${redirectTo}?${queryParams}` : redirectTo;\n        window.location.replace(url);\n    };\n    const logout = useCallback(async () => {\n        const stateCode = generateBase58(32);\n        // redirect to the hosted page\n        if (redirectOnLogout) {\n            let redirectUri = location.origin;\n            if (typeof redirectPathname === \"string\") {\n                redirectUri += redirectPathname;\n            }\n            const query = {\n                redirectUri,\n                state: stateCode,\n            };\n            const url = `${logoutURL}?${toUrlEncoded(query)}`;\n            setLoggedOut();\n            window.location.replace(url);\n        }\n        // call the logout endpoint\n        else {\n            const userToken = getSessionToken(options);\n            if (userToken) {\n                const { success, response } = await client.logout(userToken);\n                if (success) {\n                    setLoggedOut();\n                }\n                else {\n                    setError(response.summary);\n                }\n            }\n            else {\n                setLoggedOut();\n            }\n        }\n    }, []);\n    const getToken = useCallback(() => {\n        return getSessionToken(options);\n    }, []);\n    const setLoggedOut = () => {\n        if (options.useCookie) {\n            removeTokenCookies(options);\n        }\n        stopTokenWatch();\n        const storageAPI = getStorageAPI(options.useCookie);\n        storageAPI.removeItem(SESSION_DATA_KEY);\n        setError(\"\");\n        setUser(undefined);\n        setAuthenticated(false);\n    };\n    const processLogin = (response) => {\n        const user = getUserFromResponse(response);\n        const sessionData = getSessionData(options);\n        sessionData.user = user;\n        saveSessionData(sessionData, options);\n        const storageAPI = getStorageAPI(options.useCookie);\n        const returnURL = storageAPI.getItem(LAST_PATH_KEY) || \"/\";\n        const appState = {\n            userData: user,\n            returnPath: returnURL,\n            authState: storageAPI.getItem(STATE_DATA_KEY),\n        };\n        storageAPI.removeItem(LAST_PATH_KEY);\n        if (options.useCookie) {\n            setTokenCookies(user, options);\n        }\n        setError(\"\");\n        setUser(user);\n        setAuthenticated(true);\n        startTokenWatch();\n        if (onLogin) {\n            onLogin(appState);\n        }\n    };\n    const memoData = useMemo(() => ({\n        authenticated,\n        loading,\n        error,\n        user,\n        client,\n        login,\n        logout,\n        getToken,\n    }), [authenticated, loading, error, user, client, login, logout, getToken]);\n    return (_jsx(AuthContext.Provider, { value: memoData, children: _jsx(_Fragment, { children: children }) }));\n};\nexport const useAuth = () => {\n    return useContext(AuthContext);\n};\n// Convenience method and for backwards compatibility\nexport { getTokenFromCookie };\n","import { Fragment as _Fragment, jsx as _jsx } from \"react/jsx-runtime\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useState, } from \"react\";\nimport AuthNClient from \"@src/AuthNClient\";\nimport { hasAuthParams, getSessionData, getSessionToken, getSessionTokenValues, getUserFromResponse, isTokenExpiring, removeTokenCookies, saveSessionData, setTokenCookies, DEFAULT_COOKIE_OPTIONS, SESSION_DATA_KEY, } from \"@src/shared/session\";\nimport { useValidateToken, useRefresh } from \"../shared/hooks\";\nconst AuthContext = createContext({});\nexport const ComponentAuthProvider = ({ config, cookieOptions = { useCookie: false }, children, }) => {\n    const [authenticated, setAuthenticated] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState();\n    const [user, setUser] = useState();\n    const [cbParams, setCbParams] = useState();\n    const client = useMemo(() => {\n        return new AuthNClient(config);\n    }, [config]);\n    const options = {\n        useJwt: config.useJwt,\n        sessionKey: config.sessionKey || SESSION_DATA_KEY,\n        ...DEFAULT_COOKIE_OPTIONS,\n        ...cookieOptions,\n    };\n    const validateCallback = useCallback((result) => {\n        if (result.user) {\n            setAuthenticated(true);\n            setUser(result.user);\n        }\n        else {\n            setLoggedOut();\n        }\n        setLoading(false);\n    }, []);\n    const refreshCallback = useCallback((result) => {\n        if (result.user) {\n            setUser(result.user);\n            setAuthenticated(true);\n        }\n        else {\n            logout();\n        }\n        setLoading(false);\n    }, []);\n    const loadingCallback = useCallback((state) => {\n        setLoading(state);\n    }, []);\n    const validate = useValidateToken(client, options, validateCallback);\n    const { refresh, startTokenWatch, stopTokenWatch } = useRefresh(client, options, refreshCallback, loadingCallback);\n    // load data from local storage, and params from URL\n    useEffect(() => {\n        const [token, expire] = getSessionTokenValues(options);\n        // save callback params if set\n        if (hasAuthParams()) {\n            const queryString = window.location.search;\n            const urlParams = new URLSearchParams(queryString);\n            const state = urlParams.get(\"state\") || \"\";\n            const code = urlParams.get(\"code\") || \"\";\n            setCbParams({ state, code });\n        }\n        if (token) {\n            // if token is expiring or expired, try refreshing\n            if (expire && isTokenExpiring(expire)) {\n                refresh();\n            }\n            else {\n                // if token has not expired, validate that it's still good\n                validate(token);\n            }\n            startTokenWatch();\n        }\n        else {\n            setLoading(false);\n        }\n    }, []);\n    const logout = useCallback(async () => {\n        const userToken = getSessionToken(options);\n        if (userToken) {\n            const { success, response } = await client.logout(userToken);\n            if (success) {\n                setLoggedOut();\n            }\n            else {\n                setError(response);\n            }\n        }\n        else {\n            setLoggedOut();\n        }\n        stopTokenWatch();\n        // eslint-disable-next-line\n    }, [user]);\n    const getToken = useCallback(() => {\n        return getSessionToken(options);\n    }, []);\n    const setLoggedOut = () => {\n        if (options.useCookie) {\n            removeTokenCookies(options);\n        }\n        setError(undefined);\n        setUser(undefined);\n        setAuthenticated(false);\n    };\n    const setFlowComplete = useCallback((response) => {\n        const user = getUserFromResponse(response);\n        const sessionData = getSessionData(options);\n        sessionData.user = user;\n        saveSessionData(sessionData, options);\n        if (options.useCookie) {\n            setTokenCookies(user, options);\n        }\n        setError(undefined);\n        setUser(user);\n        setAuthenticated(true);\n        startTokenWatch();\n    }, []);\n    const memoData = useMemo(() => ({\n        authenticated,\n        loading,\n        error,\n        user,\n        cbParams,\n        client,\n        logout,\n        getToken,\n        setFlowComplete,\n    }), [\n        authenticated,\n        loading,\n        error,\n        user,\n        cbParams,\n        client,\n        logout,\n        getToken,\n        setFlowComplete,\n    ]);\n    return (_jsx(AuthContext.Provider, { value: memoData, children: _jsx(_Fragment, { children: children }) }));\n};\nexport const useComponentAuth = () => {\n    return useContext(AuthContext);\n};\n","export var FlowStep;\n(function (FlowStep) {\n    FlowStep[\"START\"] = \"start\";\n    FlowStep[\"SIGNUP\"] = \"signup\";\n    FlowStep[\"SIGNUP_PASSWORD\"] = \"signup/password\";\n    FlowStep[\"SIGNUP_SOCIAL\"] = \"signup/social\";\n    FlowStep[\"VERIFY_SOCIAL\"] = \"verify/social\";\n    FlowStep[\"VERIFY_PASSWORD\"] = \"verify/password\";\n    FlowStep[\"VERIFY_CAPTCHA\"] = \"verify/captcha\";\n    FlowStep[\"VERIFY_EMAIL\"] = \"verify/email\";\n    FlowStep[\"ENROLL_MFA_SELECT\"] = \"enroll/mfa/select\";\n    FlowStep[\"ENROLL_MFA_START\"] = \"enroll/mfa/start\";\n    FlowStep[\"ENROLL_MFA_COMPLETE\"] = \"enroll/mfa/complete\";\n    FlowStep[\"VERIFY_MFA_SELECT\"] = \"verify/mfa/select\";\n    FlowStep[\"VERIFY_MFA_START\"] = \"verify/mfa/start\";\n    FlowStep[\"VERIFY_MFA_COMPLETE\"] = \"verify/mfa/complete\";\n    FlowStep[\"RESET_PASSWORD\"] = \"reset/password\";\n    FlowStep[\"MFA_SELECT\"] = \"mfa/select\";\n    FlowStep[\"COMPLETE\"] = \"complete\";\n})(FlowStep || (FlowStep = {}));\n","import axios from \"axios\";\nimport AuthNClient from \"@src/AuthNClient\";\nimport { FlowStep, } from \"./types\";\nconst DEFAULT_FLOW_OPTIONS = {\n    signin: true,\n    signup: true,\n};\nconst DEFAULT_FLOW_STATE = {\n    step: FlowStep.START,\n    flowId: \"\",\n    email: \"\",\n    selectedMfa: \"\",\n    mfaProviders: [],\n    cancelMfa: true,\n    recaptchaKey: \"\",\n    qrCode: \"\",\n    passwordSignup: true,\n    socialSignup: {},\n    verifyProvider: {},\n    redirectUri: \"\",\n};\nconst API_FLOW_BASE = \"flow\";\nexport class AuthNFlowClient extends AuthNClient {\n    constructor(config, options) {\n        super(config);\n        this.options = {\n            ...DEFAULT_FLOW_OPTIONS,\n            ...options,\n        };\n        this.state = {\n            ...DEFAULT_FLOW_STATE,\n        };\n    }\n    initState(flowState) {\n        this.state = {\n            ...this.state,\n            ...flowState,\n        };\n    }\n    /*\n      Auth Flow functions\n    */\n    async start(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.START}`;\n        const flowTypes = [];\n        if (this.options.signup) {\n            flowTypes.push(\"signup\");\n        }\n        if (this.options.signin) {\n            flowTypes.push(\"signin\");\n        }\n        const payload = {\n            cb_uri: this.config.callbackUri,\n            flow_types: flowTypes,\n        };\n        if (data.email) {\n            payload.email = data.email;\n        }\n        const { success, response } = await this.post(path, payload, false);\n        if (success) {\n            // only update to the next step for 'start' calls with an email\n            if (payload.email) {\n                this.state.step = response.result?.next_step;\n                this.state.email = payload.email;\n                // if email is signed up using social, save the provider info\n                if (response.result?.verify_social) {\n                    this.state.verifyProvider = { ...response.result?.verify_social };\n                }\n            }\n            else {\n                // store configured signup methods\n                if (response.result?.signup?.password_signup === null) {\n                    this.state.passwordSignup = true;\n                }\n                if (response.result?.signup?.social_signup) {\n                    this.state.socialSignup = { ...response.result.signup.social_signup };\n                }\n            }\n            // store flow_id\n            this.state.flowId = response.result.flow_id;\n            // store recapta key\n            if (response.result?.verify_captcha?.site_key) {\n                this.state.recaptchaKey = response.result.verify_captcha.site_key;\n            }\n        }\n        return { success, response };\n    }\n    async signupPassword(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.SIGNUP_PASSWORD}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            first_name: data.firstName,\n            last_name: data.lastName,\n            password: data.password,\n        };\n        return await this.post(path, payload);\n    }\n    async signupSocial(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.SIGNUP_SOCIAL}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            cb_code: data.cbCode,\n            cb_state: data.cbState,\n        };\n        return await this.post(path, payload);\n    }\n    async verifySocial(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.VERIFY_SOCIAL}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            cb_code: data.cbCode,\n            cb_state: data.cbState,\n        };\n        return await this.post(path, payload);\n    }\n    async verifyPassword(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.VERIFY_PASSWORD}`;\n        const payload = {\n            flow_id: this.state.flowId,\n        };\n        if (data.reset) {\n            payload.reset = true;\n        }\n        else {\n            payload.password = data.password;\n        }\n        return await this.post(path, payload);\n    }\n    async verifyCaptcha(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.VERIFY_CAPTCHA}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            code: data.captchaCode,\n        };\n        return await this.post(path, payload);\n    }\n    async verifyEmail(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.VERIFY_EMAIL}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            cb_code: data.cbCode,\n            cb_state: data.cbState,\n        };\n        return await this.post(path, payload);\n    }\n    async enrollMfaStart(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.ENROLL_MFA_START}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            mfa_provider: data.mfaProvider,\n        };\n        if (data.mfaProvider === \"sms_otp\" && data.phoneNumber) {\n            payload.phone = data.phoneNumber;\n        }\n        const { success, response } = await this.post(path, payload);\n        if (success) {\n            if (response.result?.enroll_mfa_complete?.totp_secret?.qr_image) {\n                this.state.qrCode =\n                    response.result.enroll_mfa_complete.totp_secret.qr_image;\n            }\n            this.state.step = response.result?.next_step;\n        }\n        return { success, response };\n    }\n    async enrollMfaComplete(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.ENROLL_MFA_COMPLETE}`;\n        const payload = {\n            flow_id: this.state.flowId,\n        };\n        if (data.cancel) {\n            payload.cancel = true;\n        }\n        else {\n            payload.code = data.code;\n        }\n        return await this.post(path, payload);\n    }\n    async verifyMfaStart(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.VERIFY_MFA_START}`;\n        const payload = {\n            flow_id: this.state.flowId,\n            mfa_provider: data.mfaProvider,\n        };\n        return await this.post(path, payload);\n    }\n    async verifyMfaComplete(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.VERIFY_MFA_COMPLETE}`;\n        const payload = {\n            flow_id: this.state.flowId,\n        };\n        if (data.cancel) {\n            payload.cancel = true;\n        }\n        else {\n            payload.code = data.code;\n        }\n        return await this.post(path, payload);\n    }\n    async resetPassword(data) {\n        const path = `${API_FLOW_BASE}/${FlowStep.RESET_PASSWORD}`;\n        const payload = {\n            flow_id: this.state.flowId,\n        };\n        if (data.cancel) {\n            payload.cancel = true;\n        }\n        else {\n            payload.password = data.password;\n            payload.cb_code = data.cbCode;\n            payload.cb_state = data.cbState;\n        }\n        return await this.post(path, payload);\n    }\n    async complete() {\n        const path = `${API_FLOW_BASE}/${FlowStep.COMPLETE}`;\n        const payload = {\n            flow_id: this.state.flowId,\n        };\n        return await this.post(path, payload);\n    }\n    // reset state to default\n    reset() {\n        this.state = {\n            ...DEFAULT_FLOW_STATE,\n        };\n    }\n    /*\n      API Request functions\n    */\n    async post(endpoint, payload, updateState = true) {\n        try {\n            const response = await axios.post(this.getUrl(endpoint), payload, this.getOptions());\n            const success = this.processResponse(response.data, updateState);\n            if (this.state.step === FlowStep.COMPLETE) {\n                return await this.complete();\n            }\n            else if (this.state.step === FlowStep.VERIFY_MFA_START) {\n                return await this.verifyMfaStart({\n                    mfaProvider: this.state.selectedMfa || \"\",\n                });\n            }\n            else if (this.state.step === FlowStep.ENROLL_MFA_START &&\n                this.state.selectedMfa !== \"sms_otp\") {\n                return await this.enrollMfaStart({\n                    mfaProvider: this.state.selectedMfa || \"\",\n                });\n            }\n            return { success, response: response.data };\n        }\n        catch (err) {\n            return { success: false, response: this.getError(err) };\n        }\n    }\n    processResponse(response, updateState = true) {\n        let success = response.status === \"Success\";\n        // update state data if call was sucessful and updateState is true\n        if (success && updateState) {\n            // check for mfaProviders\n            if (response.result?.verify_mfa_start?.mfa_providers) {\n                this.state.mfaProviders =\n                    response.result?.verify_mfa_start?.mfa_providers === null\n                        ? []\n                        : [...response.result.verify_mfa_start.mfa_providers];\n            }\n            else if (response.result?.enroll_mfa_start?.mfa_providers) {\n                this.state.mfaProviders =\n                    response.result?.enroll_mfa_start?.mfa_providers === null\n                        ? []\n                        : [...response.result.enroll_mfa_start.mfa_providers];\n            }\n            // set default mfa if none is set\n            if (!this.state.selectedMfa && this.state.mfaProviders?.length) {\n                this.state.selectedMfa = this.state.mfaProviders[0];\n            }\n            // Handle error in response for invalid OTP code - GEA-4753\n            if (response.result?.error) {\n                success = false;\n            }\n            // set the next step\n            this.state.step = response.result?.next_step;\n        }\n        else if (!success && updateState && response.result?.next_step) {\n            // update the step on error if a step is set\n            this.state.step = response.result.next_step;\n        }\n        return success;\n    }\n}\nexport default AuthNFlowClient;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useState, } from \"react\";\nimport { FlowStep, } from \"./types\";\nimport { useComponentAuth } from \"@src/ComponentAuthProvider\";\nimport AuthNFlowClient from \"./client\";\nconst SESSION_DATA_NAME = \"pangea-authn-flow\";\nexport const AuthFlowContext = createContext({});\nexport const AuthFlowProvider = ({ children }) => {\n    const { client, cbParams, setFlowComplete } = useComponentAuth();\n    const config = {\n        clientToken: client.config.clientToken,\n        domain: client.config.domain,\n        callbackUri: client.config.callbackUri,\n    };\n    const auth = useMemo(() => {\n        return new AuthNFlowClient(config);\n    }, []);\n    const [step, setStep] = useState();\n    const [error, setError] = useState();\n    const [loading, setLoading] = useState(false);\n    const [flowData, setFlowState] = useState({});\n    // load data from local storage, and params from URL\n    useEffect(() => {\n        const sessionData = getSessionData();\n        const initFlowState = {\n            step: sessionData.step || FlowStep.START,\n        };\n        // get callback params from main provider\n        const cbCode = cbParams?.code;\n        const cbState = cbParams?.state;\n        if (sessionData.step) {\n            initFlowState.flowId = sessionData.flow_id;\n            initFlowState.recaptchaKey = sessionData.recaptcha_key;\n            initFlowState.qrCode = sessionData.qr_code;\n            initFlowState.selectedMfa = sessionData.selected_mfa;\n            initFlowState.mfaProviders = sessionData.mfa_providers;\n            initFlowState.email = sessionData.email;\n            setFlowState(initFlowState);\n        }\n        setStep(initFlowState.step);\n        // set auth client state from session\n        auth.initState(initFlowState);\n        /*\n         * Start state and callback handling\n         */\n        // social signup with callback\n        if (initFlowState.step === FlowStep.START &&\n            cbCode &&\n            cbState &&\n            initFlowState.flowId) {\n            callNext(FlowStep.SIGNUP_SOCIAL, { cbCode: cbCode, cbState: cbState });\n        }\n        // fetch social providers\n        else if (initFlowState.step === FlowStep.START) {\n            callNext(FlowStep.START, {});\n        }\n        // social login with callback\n        else if (initFlowState.step === FlowStep.VERIFY_SOCIAL &&\n            cbCode &&\n            cbState) {\n            callNext(FlowStep.VERIFY_SOCIAL, { cbCode: cbCode, cbState: cbState });\n        }\n        // verify email with callback or check if complete\n        else if (initFlowState.step === FlowStep.VERIFY_EMAIL) {\n            callNext(FlowStep.VERIFY_EMAIL, { cbCode: cbCode, cbState: cbState });\n        }\n        // eslint-disable-next-line\n    }, []);\n    const callNext = useCallback(async (step, payload) => {\n        setLoading(true);\n        switch (step) {\n            case FlowStep.START:\n                startHandler(payload);\n                break;\n            case FlowStep.SIGNUP_PASSWORD:\n                signupPasswordHandler(payload);\n                break;\n            case FlowStep.SIGNUP_SOCIAL:\n                signupSocialHandler(payload);\n                break;\n            case FlowStep.VERIFY_PASSWORD:\n                verifyPasswordHandler(payload);\n                break;\n            case FlowStep.VERIFY_SOCIAL:\n                verifySocialHandler(payload);\n                break;\n            case FlowStep.VERIFY_EMAIL:\n                verifyEmailHandler(payload);\n                break;\n            case FlowStep.VERIFY_CAPTCHA:\n                verifyCaptchaHandler(payload);\n                break;\n            case FlowStep.ENROLL_MFA_START:\n                enrollMfaStartHandler(payload);\n                break;\n            case FlowStep.ENROLL_MFA_COMPLETE:\n                enrollMfaCompleteHandler(payload);\n                break;\n            case FlowStep.VERIFY_MFA_START:\n                verifyMfaStartHandler(payload);\n                break;\n            case FlowStep.VERIFY_MFA_COMPLETE:\n                verifyMfaCompleteHandler(payload);\n                break;\n            case FlowStep.RESET_PASSWORD:\n                resetPasswordHandler(payload);\n                break;\n            case FlowStep.ENROLL_MFA_SELECT:\n                auth.state.cancelMfa = payload.cancel;\n                setNextStep(FlowStep.ENROLL_MFA_SELECT);\n                break;\n            case FlowStep.VERIFY_MFA_SELECT:\n                auth.state.cancelMfa = payload.cancel;\n                setNextStep(FlowStep.VERIFY_MFA_SELECT);\n                break;\n            default:\n                // invalid state\n                console.log(\"Invalid Flow State\", step);\n        }\n        setLoading(false);\n        // eslint-disable-next-line\n    }, [flowData]);\n    const getSessionData = () => {\n        const storedData = localStorage.getItem(SESSION_DATA_NAME);\n        if (storedData) {\n            const session = JSON.parse(storedData);\n            return session;\n        }\n        return {};\n    };\n    const updateSessionData = useCallback((data) => {\n        const sessionData = getSessionData();\n        sessionData.step = data.step;\n        sessionData.flow_id = data.flowId;\n        sessionData.email = data.email;\n        sessionData.selected_mfa = data.selectedMfa;\n        sessionData.mfa_providers = data.mfaProviders;\n        sessionData.recaptcha_key = data.recaptchaKey;\n        sessionData.qr_code = data.qrCode;\n        const dataString = JSON.stringify(sessionData);\n        localStorage.setItem(SESSION_DATA_NAME, dataString);\n    }, []);\n    const deleteSessionData = () => {\n        localStorage.removeItem(SESSION_DATA_NAME);\n    };\n    const startHandler = async (payload) => {\n        const { success, response } = await auth.start(payload);\n        updateFlowState(success, response);\n    };\n    const signupPasswordHandler = async (payload) => {\n        const { success, response } = await auth.signupPassword(payload);\n        updateFlowState(success, response);\n    };\n    const signupSocialHandler = async (payload) => {\n        const { success, response } = await auth.signupSocial(payload);\n        updateFlowState(success, response);\n    };\n    const verifyPasswordHandler = async (payload) => {\n        const { success, response } = await auth.verifyPassword(payload);\n        updateFlowState(success, response);\n    };\n    const verifySocialHandler = async (payload) => {\n        const { success, response } = await auth.verifySocial(payload);\n        updateFlowState(success, response);\n    };\n    const verifyEmailHandler = async (payload) => {\n        const { success, response } = await auth.verifyEmail(payload);\n        updateFlowState(success, response);\n    };\n    const verifyCaptchaHandler = async (payload) => {\n        const { success, response } = await auth.verifyCaptcha(payload);\n        updateFlowState(success, response);\n    };\n    const enrollMfaStartHandler = async (payload) => {\n        const { success, response } = await auth.enrollMfaStart(payload);\n        updateFlowState(success, response);\n    };\n    const enrollMfaCompleteHandler = async (payload) => {\n        // set provider when cancelling, to support changing providers\n        if (payload.cancel && payload.mfaProvider) {\n            auth.state.selectedMfa = payload.mfaProvider;\n        }\n        const { success, response } = await auth.enrollMfaComplete(payload);\n        updateFlowState(success, response);\n    };\n    const verifyMfaStartHandler = async (payload) => {\n        const { success, response } = await auth.verifyMfaStart(payload);\n        updateFlowState(success, response);\n    };\n    const verifyMfaCompleteHandler = async (payload) => {\n        // set provider when cancelling, to support changing providers\n        if (payload.cancel && payload.mfaProvider) {\n            auth.state.selectedMfa = payload.mfaProvider;\n        }\n        const { success, response } = await auth.verifyMfaComplete(payload);\n        updateFlowState(success, response);\n    };\n    const resetPasswordHandler = async (payload) => {\n        if (!payload.cancel) {\n            payload.cbCode = cbParams?.code;\n            payload.cbState = cbParams?.state;\n        }\n        const { success, response } = await auth.resetPassword(payload);\n        updateFlowState(success, response);\n    };\n    /*\n      Set flow step without an API call\n    */\n    const setNextStep = (nextStep) => {\n        auth.state.step = nextStep;\n        setStep(auth.state.step);\n        setFlowState({ ...auth.state });\n        updateSessionData(auth.state);\n    };\n    const reset = useCallback(() => {\n        auth.reset();\n        setError(undefined);\n        callNext(FlowStep.START, {});\n    }, [auth, callNext]);\n    /*\n      Common response utility\n    */\n    const updateFlowState = (success, response) => {\n        if (success) {\n            setError(undefined);\n            setStep(auth.state.step);\n            setFlowState({ ...auth.state });\n            if (auth.state.step === undefined &&\n                response.result?.active_token?.token) {\n                deleteSessionData();\n                setFlowComplete(response);\n            }\n            else {\n                updateSessionData(auth.state);\n            }\n        }\n        else {\n            setError(response);\n            console.log(\"Error\", response);\n        }\n    };\n    const memoData = useMemo(() => ({\n        step,\n        error,\n        loading,\n        flowData,\n        callNext,\n        reset,\n        cbParams,\n    }), [step, error, loading, flowData, callNext, reset, cbParams]);\n    return (_jsx(AuthFlowContext.Provider, { value: memoData, children: children }));\n};\nexport const useAuthFlow = () => {\n    return useContext(AuthFlowContext);\n};\n"],"names":["AuthNClient","constructor","config","useJwt","clientToken","Error","domain","callbackUri","window","location","origin","this","async","userToken","data","token","post","payload","code","refreshToken","user_token","refresh_token","endpoint","response","axios","getUrl","getOptions","success","status","err","getError","match","headers","Authorization","error","message","summary","result","isAxiosError","request","statusText","reqest","console","log","_arrayReduce","array","iteratee","accumulator","initAccum","index","length","_deburrLetter","object","key","undefined","basePropertyOf","freeGlobal","global","Object","freeSelf","self","_Symbol","Function","Symbol","_arrayMap","Array","isArray_1","isArray","require$$0","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","_getRawTag","value","isOwn","call","tag","unmasked","e","getRawTag","require$$1","objectToString","baseGetTag","isObjectLike","arrayMap","require$$2","isSymbol","symbolProto","symbolToString","_baseToString","baseToString","toString_1","deburrLetter","reLatin","reComboMark","RegExp","deburr_1","string","replace","reAsciiWord","_asciiWords","reHasUnicodeWord","_hasUnicodeWord","test","rsBreakRange","rsMathOpRange","rsBreak","rsDigits","rsDingbat","rsLower","rsMisc","rsRegional","rsSurrPair","rsUpper","rsMiscLower","rsMiscUpper","reOptMod","rsModifier","rsSeq","join","rsEmoji","reUnicodeWord","asciiWords","hasUnicodeWord","unicodeWords","arrayReduce","deburr","words","pattern","guard","reApos","snakeCase_1","callback","createCompounder","word","toLowerCase","BASE58_ALPHABET","generateBase58","setLength","i","charAt","Math","floor","random","toUrlEncoded","obj","keys","map","k","encodeURIComponent","snakeCase","diffInSeconds","dt1","dt2","diff","getTime","round","DEFAULT_COOKIE_OPTIONS","useCookie","cookieMaxAge","cookieName","refreshCookieName","CODE_RE","STATE_RE","hasAuthParams","searchParams","search","getStorageAPI","isUsingCookies","sessionStorage","localStorage","saveSessionData","options","storageAPI","dataString","JSON","stringify","setItem","sessionKey","getSessionData","getItem","parse","getSessionToken","getTokenFromCookie","user","active_token","getAllTokens","sessionToken","getRefreshToken","getSessionTokenValues","getTokenCookieFields","expire","name","cookie","getCookies","split","isTokenExpiring","expireTime","refreshExpires","Date","REFRESH_CHECK_INTERVAL","maybeAddSecureFlag","cookieDomain","hostname","document","str","trim","reduce","cookieObj","curr","cookieValue","setCookie","removeCookie","toUTCString","setTokenCookies","userData","userCookieValue","refreshCookieValue","removeTokenCookies","getUserFromResponse","activeToken","email","profile","useValidateToken","client","validateCallback","fetchJWKS","useCallback","jwks","warn","checkKeys","jwksJSON","cacheExpires","getJWKS","jwksData","keySet","cacheData","now","verifyJwt","jose","createLocalJWKSet","protectedHeader","jwtVerify","first_name","last_name","phone","header","verifyToken","validate","useRefresh","refreshCallback","loadingCallback","intervalId","useRef","useEffect","addEventListener","onFocus","onBlur","removeEventListener","current","clearInterval","checkTokenLife","startTokenWatch","tokenExpire","_","getTokenExpire","refresh","stopTokenWatch","setInterval","AuthContext","createContext","useComponentAuth","useContext","FlowStep","DEFAULT_FLOW_OPTIONS","signin","signup","DEFAULT_FLOW_STATE","step","START","flowId","selectedMfa","mfaProviders","cancelMfa","recaptchaKey","qrCode","passwordSignup","socialSignup","verifyProvider","redirectUri","AuthNFlowClient","super","state","initState","flowState","path","flowTypes","push","cb_uri","flow_types","next_step","verify_social","password_signup","social_signup","flow_id","verify_captcha","site_key","SIGNUP_PASSWORD","firstName","lastName","password","SIGNUP_SOCIAL","cb_code","cbCode","cb_state","cbState","VERIFY_SOCIAL","VERIFY_PASSWORD","reset","VERIFY_CAPTCHA","captchaCode","VERIFY_EMAIL","ENROLL_MFA_START","mfa_provider","mfaProvider","phoneNumber","enroll_mfa_complete","totp_secret","qr_image","ENROLL_MFA_COMPLETE","cancel","VERIFY_MFA_START","VERIFY_MFA_COMPLETE","RESET_PASSWORD","COMPLETE","updateState","processResponse","complete","verifyMfaStart","enrollMfaStart","verify_mfa_start","mfa_providers","enroll_mfa_start","AuthFlowContext","children","cbParams","setFlowComplete","auth","useMemo","setStep","useState","setError","loading","setLoading","flowData","setFlowState","sessionData","initFlowState","recaptcha_key","qr_code","selected_mfa","callNext","startHandler","signupPasswordHandler","signupSocialHandler","verifyPasswordHandler","verifySocialHandler","verifyEmailHandler","verifyCaptchaHandler","enrollMfaStartHandler","enrollMfaCompleteHandler","verifyMfaStartHandler","verifyMfaCompleteHandler","resetPasswordHandler","ENROLL_MFA_SELECT","setNextStep","VERIFY_MFA_SELECT","storedData","updateSessionData","start","updateFlowState","signupPassword","signupSocial","verifyPassword","verifySocial","verifyEmail","verifyCaptcha","enrollMfaComplete","verifyMfaComplete","resetPassword","nextStep","removeItem","memoData","_jsx","jsx","Provider","loginUrl","onLogin","cookieOptions","redirectPathname","redirectOnLogout","useStrictStateCheck","authenticated","setAuthenticated","setUser","slashRe","loginURL","signupURL","logoutURL","appState","returnPath","pathname","logout","exchange","queryString","urlParams","URLSearchParams","savedState","get","delete","newSearch","newPath","history","pushState","title","userinfo","processLogin","login","stateCode","query","append","queryParams","redirectTo","url","setLoggedOut","getToken","authState","_Fragment","Fragment","setCbParams","source","TextEncoder","encode","Uint8Array","c","charCodeAt","x","BigInt","uint8a","hex","padStart","bytesToHex","output","mod","Number","reverse"],"mappings":"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"}